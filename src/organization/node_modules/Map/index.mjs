import registry from 'registry';
import loadMap from 'load-map';
import Location from 'Location';

export default class Map {

  universe = null;

  constructor(){
  }

  async initialize(){

    this.universe = new Location();
    this.universe.root = this.universe;
    this.universe.parent = this.universe;
    this.universe.id="universe",
    this.universe.name="universe",
    this.universe.label="Universe"

    // LOAD MAP HERE
    await this.loadMap(registry.mapFile);

  }

  async loadMap(xmlFile) {
    await loadMap({ attachTo: this.universe, xmlFile, });
  } // load

  location(id){
    let finding = null;
    const finder = function(node){
      if(node.id === id) {
        finding = node;
        return;
      }
      if(node.getElements) node.getElements().forEach(function(child){
        finder(child)
      })
    }
    finder(this.universe);
    return finding;
  }

}
